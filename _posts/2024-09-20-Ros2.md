---
layout: post
title:  "Ros2"
---

# Ros2
## Turtlesim Package Installation
ROS 유저라면 사용해보지 않은 사람이 없을 정도로 유명한 패키지이자 ROS의 기본 기능을 가지고 있기에 많은 사람들이 튜토리얼로써 많이 이용하는 `turtlesim`을 가지고 이번 강좌를 진행


## Concepts
**Node**: 최소 단위의 실행 가능한 프로세스, 하나의 실행 가능한 프로그램 <br/>
-노드의 역할을 목적에 맞추어 세분화시켜 노드들 간의 의존성을 줄여 독립성을 다른 목적의 작업시 재사용 가능하게 함 <br/>
-ex.원본 영상을 출력하는 카메라 드라이버, 원본 영상에 필터링하는 필터 노드, 필터링 된 영상에서 특징점을 추출하는 노드, 특징점을 이용해 물건을 검출하는 노드, 검출된 물건의 위치로 로봇의 경로를 만들어내는 노드, 모터 드라이버 노드, 경로대로 이동하는 노드 <br/> 
**Message**: 노드와 노드 사이에 서로 주고받는 입력과 출력 데이터 <br/>
-message의 형태는 integer, floating point, boolean, string 와 같은 변수 형태 <br/>
-message 안에 message를 품고 있는 간단한 데이터 구조 및 메시지들의 배열과 같은 구조도 사용 <br/>
**Message Communication**: 노드와 노드 사이에 입출력 데이터를 주고받는 방식 <br/>
-ex <br/>
![MobilityService1](https://github.com/user-attachments/assets/7f60bc44-82f0-4a6b-89fb-2b0001972399) <br/>
## Message를 주고받는 방식
**Topic(토픽)** <br/>
비동기식 단방향 메시지 송수신 방식으로 msg 메시지 형태의 메시지를 발간하는 Publisher와 메시지를 구독하는 Subscriber 간의 통신 <br/>
-1:N, N:1, N:N 통신도 가능함 <br/>
-ROS 메시지 통신에서 가장 널리 사용되는 통신 방법 <br/>
-ex. NodeA - NodeB, NodeA - NodeC <br/>

**Service(서비스)** <br/>
동기식 양방향 메시지 송수신 방식으로 특정 요청을 하는 클라이언트 단과 요청받은 일을 수행 후에 결괏값을 전달하는 서버 단과의 통신 <br/>
-서비스의 요청(Request)을 하는 쪽을 Service client라고 하며 서비스의 응답(Response)을 하는 쪽을 Service server라고 한다 <br/>
-서비스 요청 및 응답(Request/Response) 또한 위에서 언급한 msg 메시지의 변형으로 srv 메시지라고 함 <br/>
-ex. Node B - Node C <br/>
![MobilityService2](https://github.com/user-attachments/assets/7cdc7ba2-2d47-4a88-8533-b58c6a3121b5) <br/>

**Action(액션)** <br/>
비동기식+동기식 양방향 메시지 송수신 방식 <br/>
액션 목표 Goal를 지정하는 Action client과 액션 목표를 받아 특정 태스크를 수행하면서 중간 결괏값에 해당되는 액션 피드백(Feedback)과 최종 결괏값에 해당되는 액션 결과(Result)를 전송하는 Action server 간의 통신 <br/>
-액션의 구현 방식은 토픽(topic)과 서비스(service)의 혼합이라고 볼 수 있는데 액션 목표 및 액션 결과를 전달하는 방식은 서비스와 같으며 액션 피드백은 토픽과 같은 메시지 전송 방식 <br/>
-액션 목표/피드백/결과(Goal/Feedback/Result) 메시지 또한 위에서 언급한 msg 메시지의 변형으로 action 메시지라고 한다 <br/>
![MobilityService3](https://github.com/user-attachments/assets/d373d312-a32f-4aa5-9194-8ee710a9c752) <br/>
![MobilityService4](https://github.com/user-attachments/assets/86e1ab45-abd6-4efa-a4bc-01620599478d) <br/>

**Parameter(파라미터)** <br/>
각 노드에 파라미터 관련 Parameter server를 실행시켜 외부의 Parameter client 간의 통신으로 파라미터를 변경하는 것으로 서비스와 동일 <br/>
단 노드 내 매개변수 또는 글로벌 매개변수를 서비스 메시지 통신 방법을 사용하여 노드 내부 또는 외부에서 쉽게 지정(Set) 하거나 변경할 수 있고, 쉽게 가져(Get)와서 사용할 수 있게 하는 점에서 목적이 다르다 <br/>
![MobilityService5](https://github.com/user-attachments/assets/32e29990-4da4-4245-aa8b-7d8836c20f52) <br/>

## 노드 실행 (ros2 run)
노드를 실행하기 위해서는 아래와 같이 `ros2 run` 명령어를 이용하여 특정 패키지의 특정 노드를 실행시키게 된다. <br/>
아래의 두 명령어는 각각 `turtlesim` 패키지의 `turtlesim_node`와 `turtle_teleop_key` 노드를 실행시키게 된다. <br/>



Reference: <br/>
[출처] 007 패키지 설치와 노드 실행 (오픈소스 소프트웨어 & 하드웨어: 로봇 기술 공유 카페 (오로카)) | 작성자 표윤석 <br/>


